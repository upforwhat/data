var baidusearch=(function(){function a(b){e(document,"mouseup",d);function d(){var f="getSelection" in window;var g=document.getElementById("selectsearch-icon");if(g){g.parentNode.removeChild(g)}setTimeout(function(){selection=f?window.getSelection():document.selection.createRange();var h=(f?selection+"":selection.text).replace(/\n+/g,"");if(h&&h.length){if(h.length>76){h=h.substring(0,76)}c(f,selection,h)}},25)}function c(h,o,p){var g=document.body.scrollTop+document.documentElement.scrollTop;var i=document.body.scrollLeft+document.documentElement.scrollLeft;if(h){var l=o.getRangeAt(0).getBoundingClientRect();if(l.top==0&&l.right==0){return}var f=l.top>35?l.top-35+g:g;var j=l.right+70>document.documentElement.clientWidth?document.documentElement.clientWidth-65+i:l.right+5+i}else{var m=o.boundingLeft+o.boundingWidth;var f=o.boundingTop>35?o.boundingTop-35+g:g;var j=m+70>document.documentElement.clientWidth?document.documentElement.clientWidth-65+i:m+i}var p=encodeURI(p);var k=document.createElement("img");k.src="http://img.baidu.com/img/iknow/qb/select-search.png";k.alt="搜索";k.style.cssText="width:65px; height:31px; border:0px none;";var n=document.createElement("a");n.id="selectsearch-icon";n.style.cssText="cursor:pointer; position:absolute;";n.href="http://www.baidu.com/s?ie=utf-8&wd="+p+"&tn="+b+"&hl_tag=flayer";n.target="_blank";n.onclick=function(){n.parentNode.removeChild(n)};n.style.left=j+"px";n.style.top=f+"px";n.appendChild(k);document.body.appendChild(n);k.onmouseup=function(q){q=q||window.event;if(q.stopPropagation){q.stopPropagation()}else{q.cancelBubble=true}}}function e(h,f,g){if(window.attachEvent){h.attachEvent("on"+f,g)}else{if(window.addEventListener){h.addEventListener(f,g,false)}}}}return{init:a}})();
